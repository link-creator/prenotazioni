<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dog Sitting Luxury Night</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/css/intlTelInput.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        :root { --primary: #1a2a6c; --bg: #0b1120; --accent: #fbbf24; --white: #ffffff; --ok: #10b981; --warn: #f59e0b; --no: #ef4444; }

        html { height: 100%; }
        body {
            margin: 0;
            padding: 20px 10px;
            font-family: 'Poppins', sans-serif;
            color: #f1f5f9;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            background-color: #0b1120;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: "";
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, #0b1120 0%, #1a2a6c 100%);
            z-index: -2;
        }

        .clouds-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            overflow: hidden;
            z-index: -1;
            pointer-events: none;
        }
        .cloud {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 100px;
            filter: blur(15px);
            animation: moveClouds linear infinite;
        }
        .c1 { width: 200px; height: 60px; top: 15%; left: -250px; animation-duration: 10s; }
        .c2 { width: 300px; height: 90px; top: 45%; left: -350px; animation-duration: 15s; animation-delay: 2s; }
        .c3 { width: 150px; height: 50px; top: 75%; left: -200px; animation-duration: 12s; animation-delay: 5s; }

        @keyframes moveClouds {
            from { transform: translateX(-100px); }
            to { transform: translateX(calc(100vw + 400px)); }
        }

        .lang-container { align-self: flex-end; margin-bottom: 15px; z-index: 10; }
        #langSelect { 
            background: #1a2a6c;
            color: white; 
            border: 1px solid rgba(255,255,255,0.6); 
            border-radius: 50px; 
            padding: 8px 15px; 
            font-size: 14px;
            font-family: inherit;
            appearance: none;
            -webkit-appearance: none;
            outline: none;
            cursor: pointer;
        }
        #langSelect option { background: #0b1120; color: white; }

        .status-box { width: 100%; max-width: 500px; padding: 15px; border-radius: 15px; text-align: center; margin-bottom: 15px; font-weight: bold; box-sizing: border-box; background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.1); }
        .status-open { color: var(--ok); }
        .status-closed-book { color: var(--warn); }

        .hours-table { width: 100%; max-width: 500px; background: rgba(255,255,255,0.08); padding: 15px; border-radius: 15px; margin-bottom: 20px; border: 1px solid rgba(255,255,255,0.1); box-sizing: border-box; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); }
        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        th { color: var(--accent); text-align: left; padding-bottom: 5px; }
        td { padding: 5px 0; color: #cbd5e1; border-bottom: 1px solid rgba(255,255,255,0.05); }

        .container { background: var(--white); color: #333; padding: 25px; border-radius: 25px; max-width: 500px; width: 100%; box-sizing: border-box; box-shadow: 0 15px 40px rgba(0,0,0,0.6); z-index: 5; }
        h1 { color: var(--primary); text-align: center; margin-bottom: 20px; font-size: 22px; font-weight: 600; }
        
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: 600; font-size: 13px; color: #475569; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #e2e8f0; border-radius: 12px; font-size: 16px; font-family: inherit; box-sizing: border-box; background: #f8fafc; }
        
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; margin-top: 10px; }
        .day { padding: 8px; text-align: center; background: #f1f5f9; border-radius: 8px; cursor: pointer; font-size: 11px; color: #1e293b; }
        .day.selected { background: var(--primary) !important; color: white !important; font-weight: bold; }
        .day.header { font-weight: bold; color: #94a3b8; background: transparent; }
        .day.closed { color: var(--no); background: #fee2e2; opacity: 0.4; }

        .btn-submit { background: var(--primary); color: white; border: none; padding: 16px; border-radius: 50px; width: 100%; font-weight: bold; cursor: pointer; font-size: 17px; margin-top: 10px; box-shadow: 0 4px 15px rgba(26, 42, 108, 0.3); }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.92); justify-content: center; align-items: center; z-index: 9999; padding: 15px; }
        .modal-content { background: white; padding: 30px; border-radius: 25px; text-align: center; width: 100%; max-width: 400px; color: #333; }
        
        .hidden { display: none; }
        .progress-container { display: none; width: 100%; background: #f1f5f9; border-radius: 10px; margin: 15px 0; overflow: hidden; }
        .progress-bar { width: 0%; height: 8px; background: var(--primary); transition: width 0.3s; }
    </style>
</head>
<body>

    <div class="clouds-container">
        <div class="cloud c1"></div>
        <div class="cloud c2"></div>
        <div class="cloud c3"></div>
    </div>

    <div class="lang-container">
        <select id="langSelect" onchange="changeLanguage()">
            <option value="en" selected>English üá¨üáß</option>
            <option value="it">Italiano üáÆüáπ</option>
        </select>
    </div>

    <div id="statusBox" class="status-box"></div>

    <div class="hours-table">
        <table>
            <thead>
                <tr><th id="thDays">Days</th><th id="thHours">Hours</th></tr>
            </thead>
            <tbody>
                <tr><td id="rowMT">Mon - Tue</td><td style="color:var(--no); font-weight:bold;" id="rowClosed">CLOSED</td></tr>
                <tr><td id="rowWS">Wed - Sun</td><td>19:30 - 22:30</td></tr>
            </tbody>
        </table>
    </div>

    <div class="container">
        <h1 id="title">üåô Night Dog Sitting</h1>
        <form id="nightForm">
            <div class="form-group"><label id="l1">Full Name</label><input type="text" id="fullname" placeholder="John Doe" required></div>
            <div class="form-group"><label id="l2">Phone</label><input type="tel" id="phone" required></div>
            <div class="form-group"><label id="l3">Duration</label>
                <select id="duration">
                    <option value="1">1 hour - 20‚Ç¨</option>
                    <option value="2">2 hours - 30‚Ç¨</option>
                    <option value="3">3 hours - 35‚Ç¨</option>
                </select>
            </div>
            <div class="form-group"><label id="l4">Number of Dogs</label><select id="dogCount" onchange="toggleDogs()"><option value="1">1</option><option value="2">2</option></select></div>
            <div class="form-group"><input type="text" id="dog1" placeholder="Dog name" required></div>
            <div id="extraDog" class="form-group hidden"><input type="text" id="dog2" placeholder="Second dog name"></div>
            
            <div class="form-group">
                <label id="l5">Choose the night</label>
                <div id="monthLabel" style="text-align:center; font-weight:bold; color: var(--primary); margin-bottom: 8px;">June 2026</div>
                <div class="calendar-grid" id="calendarGrid"></div>
                <input type="hidden" id="selectedDate">
            </div>

            <div class="form-group">
                <label id="l6">Start Time (19:30 - 22:30)</label>
                <input type="time" id="startTime" required>
            </div>

            <div class="form-group"><label id="l7">Port</label><input type="text" id="marina" required></div>
            <div class="form-group"><label id="l8">Pier</label><input type="text" id="pontile" required></div>
            <div class="form-group"><label id="l9">Notes</label><textarea id="notes" rows="1"></textarea></div>
            
            <div class="progress-container" id="progressContainer"><div class="progress-bar" id="progressBar"></div></div>
            <button type="button" id="btn" class="btn-submit" onclick="send()">Book Now</button>
        </form>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <h2 id="mTitle">Sent!</h2>
            <p id="mMeeting" style="background: #fef3c7; padding: 12px; border-radius: 12px; color: #92400e; font-weight: 600; font-size: 14px; border: 1px solid #fcd34d;">üìç Meeting point: Pier entrance</p>
            <div id="pDisp" style="font-size:35px; font-weight:bold; color:var(--primary); margin:15px 0;"></div>
            <button class="btn-submit" onclick="downloadPDF()" style="background:var(--ok);">üìÑ Download PDF</button>
            <button class="btn-submit" onclick="location.reload()" style="background:#64748b; margin-top:10px;">Close</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/js/intlTelInput.min.js"></script>
    <script>
        const url = 'https://script.google.com/macros/s/AKfycbwPP-RM3qo2VcTal_xfk-ZfqwxO5UDOWInyXcOf8RKoDe1NXwH_ByjI3B91eMjdHtJj/exec';
        const iti = window.intlTelInput(document.querySelector("#phone"), { initialCountry: "it", separateDialCode: true, utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/js/utils.js" });

        const trans = {
            en: { title:"üåô Night Dog Sitting", l1:"Full Name", l2:"Phone", l3:"Duration", l4:"Number of Dogs", l5:"Choose the night", l6:"Start Time", l7:"Port", l8:"Pier", l9:"Notes", btn:"Book Now", month:"June 2026", open:"SERVICE OPEN üåô", closedBook:"SERVICE CLOSED - BOOK ANYWAY", mTitle:"Sent!", mMeeting:"üìç Meeting point: Pier entrance", alertC:"Closed Mon-Tue", timeErr:"Service available 19:30-22:30", pickD:"Pick a date!", thDays:"Days", thHours:"Hours", rowMT:"Mon - Tue", rowWS:"Wed - Sun", rowClosed:"CLOSED" },
            it: { title:"üåô Dog Sitting Notturno", l1:"Nome e Cognome", l2:"Telefono", l3:"Durata", l4:"Numero Cani", l5:"Scegli la notte", l6:"Ora d'inizio", l7:"Porto", l8:"Pontile", l9:"Note", btn:"Prenota Ora", month:"Giugno 2026", open:"SERVIZIO APERTO üåô", closedBook:"SERVIZIO CHIUSO - PRENOTA PURE", mTitle:"Inviata!", mMeeting:"üìç Punto di ritrovo: entrata del pontile", alertC:"Chiuso Lun-Mar", timeErr:"Servizio disponibile 19:30-22:30", pickD:"Scegli una data!", thDays:"Giorni", thHours:"Orari", rowMT:"Lun - Mar", rowWS:"Mer - Dom", rowClosed:"CHIUSO" }
        };

        // IMPOSTATO SU INGLESE DEFAULT
        let currentLang = 'en';

        function toggleDogs() { document.getElementById('extraDog').classList.toggle('hidden', document.getElementById('dogCount').value==='1'); }
        
        function changeLanguage() {
            currentLang = document.getElementById('langSelect').value;
            const t = trans[currentLang];
            document.getElementById('title').innerText = t.title;
            document.getElementById('l1').innerText = t.l1; document.getElementById('l2').innerText = t.l2;
            document.getElementById('l3').innerText = t.l3; document.getElementById('l4').innerText = t.l4;
            document.getElementById('l5').innerText = t.l5; document.getElementById('l6').innerText = t.l6;
            document.getElementById('l7').innerText = t.l7; document.getElementById('l8').innerText = t.l8;
            document.getElementById('l9').innerText = t.l9; document.getElementById('btn').innerText = t.btn;
            document.getElementById('monthLabel').innerText = t.month;
            document.getElementById('mTitle').innerText = t.mTitle;
            document.getElementById('mMeeting').innerText = t.mMeeting;
            document.getElementById('thDays').innerText = t.thDays;
            document.getElementById('thHours').innerText = t.thHours;
            document.getElementById('rowMT').innerText = t.rowMT;
            document.getElementById('rowWS').innerText = t.rowWS;
            document.getElementById('rowClosed').innerText = t.rowClosed;
            updateStatus(); buildCalendar();
        }

        function updateStatus() {
            const now = new Date(); const d = now.getDay(); const h = now.getHours() + now.getMinutes()/60;
            const open = (d !== 1 && d !== 2) && (h >= 19.5 && h <= 22.5);
            const box = document.getElementById('statusBox');
            if (open) { box.innerText = trans[currentLang].open; box.className = "status-box status-open"; }
            else { box.innerText = trans[currentLang].closedBook; box.className = "status-box status-closed-book"; }
        }

        function buildCalendar() {
            const grid = document.getElementById('calendarGrid'); grid.innerHTML = '';
            const heads = currentLang === 'it' ? ['L','M','M','G','V','S','D'] : ['M','T','W','T','F','S','S'];
            heads.forEach(h => grid.innerHTML += `<div class="day header">${h}</div>`);
            for(let i=1; i<=30; i++) {
                const div = document.createElement('div'); div.className = 'day'; div.innerText = i;
                const dw = new Date(2026, 5, i).getDay();
                if(dw === 1 || dw === 2) { div.classList.add('closed'); div.onclick = () => alert(trans[currentLang].alertC); }
                else { div.onclick = () => { document.querySelectorAll('.day').forEach(d=>d.classList.remove('selected')); div.classList.add('selected'); document.getElementById('selectedDate').value = i + " " + trans[currentLang].month; }; }
                grid.appendChild(div);
            }
        }

        function send() {
            const timeIn = document.getElementById('startTime');
            if(!timeIn.value) return;
            const [hrs, mins] = timeIn.value.split(':').map(Number);
            const total = hrs * 60 + mins;
            if(total < 1170 || total > 1350) { alert(trans[currentLang].timeErr); return; }
            if(!document.getElementById('selectedDate').value) { alert(trans[currentLang].pickD); return; }

            const btn = document.getElementById('btn');
            btn.disabled = true;
            document.getElementById('progressContainer').style.display = 'block';
            let w = 0; const iv = setInterval(() => { if(w>=90) clearInterval(iv); else { w+=10; document.getElementById('progressBar').style.width = w+'%'; } }, 150);

            const payload = {
                fullname: document.getElementById('fullname').value,
                phone: iti.getNumber(),
                duration: document.getElementById('duration').value + "h",
                dogCount: document.getElementById('dogCount').value,
                dogNames: document.getElementById('dog1').value + (document.getElementById('dog2').value ? ", " + document.getElementById('dog2').value : ""),
                selectedDate: document.getElementById('selectedDate').value,
                startTime: timeIn.value,
                marina: document.getElementById('marina').value,
                pontile: document.getElementById('pontile').value,
                notes: document.getElementById('notes').value,
                price: document.getElementById('duration').options[document.getElementById('duration').selectedIndex].text.split('-')[1].trim()
            };

            fetch(url, { method: 'POST', mode: 'no-cors', body: JSON.stringify(payload) })
            .then(() => { 
                document.getElementById('progressBar').style.width = '100%';
                setTimeout(() => { document.getElementById('pDisp').innerText = payload.price; document.getElementById('modal').style.display = 'flex'; }, 500);
            });
        }

        function downloadPDF() {
            const { jsPDF } = window.jspdf; const doc = new jsPDF();
            doc.text("Luxury Dog Sitting - Night", 20, 30);
            doc.text("Client: " + document.getElementById('fullname').value, 20, 50);
            doc.text("Date: " + document.getElementById('selectedDate').value, 20, 60);
            doc.text("Meeting point: Pier entrance", 20, 80);
            doc.save("Receipt.pdf");
        }

        // Lancio automatico in inglese
        window.onload = changeLanguage;
    </script>
</body>
</html>
